# 🎨 视觉文本生成系统

基于图像和提示词，AI 自动生成文本内容

## 📋 项目说明

本项目使用 BLIP-2 视觉语言模型，可以根据图片和你的提示词生成各种文本内容。

### 🎯 功能特点

- ✅ **多种生成类型**：描述、故事、标题、分析等
- ✅ **自定义提示**：支持输入任意提示词
- ✅ **中文翻译**：自动将英文翻译成中文
- ✅ **双语显示**：同时显示中文和英文原文
- ✅ **拖拽上传**：支持点击或拖拽图片
- ✅ **实时预览**：上传后立即预览
- ✅ **美观界面**：现代化的 Web 设计

## 🚀 快速开始

### 方法 1：使用启动脚本（推荐）

双击运行 `启动Web服务.bat`

### 方法 2：命令行启动

```bash
D:\aaaalokda\envs\myenv\python.exe 视觉文本生成Web服务.py
```

### 访问服务

启动后在浏览器中访问：http://127.0.0.1:5001

## 📖 使用说明

### 1. 上传图片

- 点击上传区域选择图片
- 或直接拖拽图片到上传区域

### 2. 选择生成类型

**预设类型：**
- 📝 **详细描述**：生成图片的详细描述
- 📖 **创作故事**：根据图片创作一个故事
- ✍️ **生成标题**：为图片生成标题或标语
- 🔍 **分析内容**：分析图片中发生的事情
- ❓ **自由提问**：询问关于图片的任何问题

**自定义提示：**
- 在文本框中输入你的提示词
- 例如："这张图片讲述了什么故事？"
- 例如："为这张图片写一段创意文案"

### 3. 生成内容

- 点击"生成内容"按钮
- AI 将根据图片和提示生成文本
- 自动翻译成中文并显示

## 🎨 应用场景

### 1. 📝 内容创作
为图片生成配文、说明文字

### 2. 📖 故事创作
根据图片创作故事、小说片段

### 3. 🤖 AI 助手
图像理解、内容分析

### 4. 📱 社交媒体
自动生成创意文案、标题

### 5. 🎓 教育培训
图片讲解、内容说明

## 🤖 技术细节

### 使用的模型

**1. Salesforce/blip2-opt-2.7b**（视觉语言模型）
- 基于 BLIP-2 架构
- 结合视觉编码器和语言模型
- 支持图像理解和文本生成
- 模型大小：约 3GB

**2. Google 翻译**（英译中）
- 自动将英文翻译成中文
- 保留英文原文供参考

### 生成参数

- `max_length=200`：最多生成 200 个词
- `min_length=20`：至少生成 20 个词
- `num_beams=5`：使用 beam search 提高质量
- `temperature=0.7`：控制生成的创造性

## 💡 使用技巧

### 1. 提示词技巧

**好的提示词：**
- ✅ "详细描述这张图片中的场景和氛围"
- ✅ "根据这张图片写一个温馨的故事"
- ✅ "分析图片中人物的情绪和动作"

**不好的提示词：**
- ❌ "说说"（太模糊）
- ❌ "好看吗"（主观问题）
- ❌ "预测未来"（超出能力）

### 2. 生成类型选择

- **描述**：适合需要客观描述的场景
- **故事**：适合有情节、有想象空间的图片
- **标题**：适合需要简短精炼的文案
- **分析**：适合需要理解内容的场景

### 3. 图片质量

- 使用清晰的图片
- 主体明确的图片效果更好
- 避免过于复杂的场景

## 📁 项目结构

```
视觉文本生成/
├── 视觉文本生成Web服务.py    # Web 服务主程序
├── 视觉文本生成示例.py        # 命令行示例
├── 启动Web服务.bat           # 启动脚本
├── 背景.png                 # 自定义背景图片
└── README.md               # 本文档
```

## 🔧 环境要求

- Python 3.8+
- transformers 4.37.0+
- torch 2.0+
- flask 3.0+
- Pillow
- googletrans 4.0.0rc1

## 📊 模型信息

| 属性 | 说明 |
|------|------|
| 模型名称 | Salesforce/blip2-opt-2.7b |
| 模型大小 | ~3 GB |
| 任务类型 | Image-to-Text (条件生成) |
| 输出语言 | 英文（自动翻译成中文） |
| 架构 | BLIP-2 + OPT-2.7B |

## 🎓 进阶使用

### 提示词示例

**1. 详细描述**
```
Describe this image in detail, including colors, objects, and atmosphere.
```

**2. 创意故事**
```
Write a creative short story based on this image. Include characters, plot, and emotions.
```

**3. 营销文案**
```
Write a compelling marketing caption for this product image.
```

**4. 场景分析**
```
Analyze the scene in this image. What is happening? What is the mood?
```

**5. 问答**
```
What can you tell me about the people in this image? What are they doing?
```

### 调整生成参数

如需修改生成效果，可以调整代码中的参数：

```python
outputs = model.generate(
    **inputs,
    max_length=300,      # 增加长度
    min_length=50,       # 增加最小长度
    num_beams=10,        # 提高质量
    temperature=0.9      # 增加创造性
)
```

## ❓ 常见问题

### Q1: 首次运行很慢？
A: 首次运行需要下载 BLIP-2 模型（约 3GB），请耐心等待。

### Q2: 生成的内容不够详细？
A: 尝试：
- 使用更具体的提示词
- 增加 `max_length` 参数
- 使用"详细描述"类型

### Q3: 生成的内容不准确？
A: 确保：
- 图片清晰
- 提示词明确
- 主体突出

### Q4: 支持中文提示词吗？
A: 模型主要支持英文提示词。中文提示词可能效果不佳，建议使用英文。

### Q5: 可以生成多个结果吗？
A: 当前版本生成单个结果。如需多个结果，可以多次点击生成按钮。

## 📝 更新日志

### v1.0.0 (2026-01-31)
- ✅ 初始版本发布
- ✅ 支持图片上传和文本生成
- ✅ 提供多种预设生成类型
- ✅ 支持自定义提示词
- ✅ 自动中文翻译
- ✅ 提供 Web 界面

## 📄 许可证

本项目仅供学习和研究使用。

## 🙏 致谢

- Hugging Face Transformers
- Salesforce BLIP-2 模型
- Flask Web 框架
- Google 翻译 API
