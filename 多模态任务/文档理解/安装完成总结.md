# 文档理解Web服务 - 安装完成总结 ✅

## 安装状态

### ✅ 已完成
1. **Python包**
   - ✅ pdf2image (1.17.0)
   - ✅ python-docx (1.2.0)

2. **系统工具**
   - ✅ Poppler (24.08.0)
   - 安装位置: `C:\Program Files\poppler`
   - PATH已配置: `C:\Program Files\poppler\Library\bin`

### ⚠️ 可选安装
- ⚠️ docx2pdf - Word完整支持（需要Microsoft Word）
  ```bash
  pip install docx2pdf
  ```

## 当前支持的格式

| 格式 | 状态 | 说明 |
|------|------|------|
| 📷 JPG/PNG/BMP/GIF | ✅ 完全支持 | 默认支持，无需额外配置 |
| 📕 PDF文档 | ✅ 完全支持 | Poppler已安装 |
| 📘 Word文档 (.docx) | ✅ 基础支持 | 可读取，完整转换需docx2pdf |

## 首次运行说明

### 模型下载
首次运行时会自动下载模型 `impira/layoutlm-document-qa`（约400MB）

如果遇到网络问题（SSL错误），可以：

1. **使用镜像站**（推荐）
   ```bash
   # 设置HuggingFace镜像
   set HF_ENDPOINT=https://hf-mirror.com
   python 文档理解Web服务.py
   ```

2. **手动下载模型**
   - 访问: https://hf-mirror.com/impira/layoutlm-document-qa
   - 下载所有文件到: `预训练模型下载处/models--impira--layoutlm-document-qa`

3. **使用VPN/代理**
   ```bash
   # 设置代理
   set HTTP_PROXY=http://127.0.0.1:7890
   set HTTPS_PROXY=http://127.0.0.1:7890
   python 文档理解Web服务.py
   ```

## 快速测试

### 测试图片支持
```bash
python 文档理解Web服务.py
# 上传任意图片格式的文档
```

### 测试PDF支持
```bash
python 文档理解Web服务.py
# 上传PDF文件（会自动转换为图片处理）
```

### 测试Word支持
```bash
python 文档理解Web服务.py
# 上传.docx文件
```

## 使用建议

### 推荐格式
1. **最佳**: 高清扫描件（JPG/PNG）
2. **次选**: PDF文档（单页效果最好）
3. **可用**: Word文档（建议先转PDF）

### 文档要求
- 分辨率: 1000-2000像素宽度
- 文件大小: < 5MB
- 文字清晰度: 越清晰效果越好
- 排版: 简单清晰的排版效果更好

## 应用场景

### 发票处理
```
问题示例:
- What is the invoice number?
- What is the total amount?
- What is the date?
- Who is the vendor?
```

### 合同分析
```
问题示例:
- What is the contract date?
- Who are the parties?
- What is the term?
- What is the payment amount?
```

### 表单识别
```
问题示例:
- What is the name?
- What is the address?
- What is the phone number?
- What is the email?
```

## 启动服务

```bash
cd 实战训练\多模态任务\文档理解
python 文档理解Web服务.py
```

服务会自动打开浏览器访问: http://localhost:8001

## 故障排除

### 问题1: 模型下载失败
**症状**: SSL错误、连接超时  
**解决**: 使用镜像站或代理（见上文）

### 问题2: PDF转换失败
**症状**: 提示poppler未安装  
**解决**: 重启命令行窗口，确保PATH生效

### 问题3: Word文档无法处理
**症状**: 提示docx2pdf未安装  
**解决**: 
- 方案1: 安装docx2pdf（需要Microsoft Word）
- 方案2: 将Word导出为PDF后上传

### 问题4: 识别准确率低
**解决**:
- 提高图片分辨率
- 确保文字清晰
- 简化文档排版
- 调整图片对比度

## 下一步

1. ✅ 所有依赖已安装
2. ⏳ 首次运行需下载模型
3. 🚀 下载完成后即可使用

## 技术支持

- 安装说明: `安装说明.md`
- 快速启用: `快速启用PDF支持.md`
- 示例代码: `文档理解示例.py`

---

**安装完成时间**: 2026年2月1日  
**Poppler版本**: 24.08.0  
**Python包**: pdf2image 1.17.0, python-docx 1.2.0
