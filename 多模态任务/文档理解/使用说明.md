# 📄 文档理解Web服务 - 使用说明

## 🚀 快速启动

### 方法1：使用启动脚本（推荐）
双击运行 `启动文档理解服务.bat`

### 方法2：命令行启动
```bash
D:\aaaalokda\python.exe 文档理解Web服务.py
```

服务启动后会自动打开浏览器访问 http://localhost:8001

---

## 📋 支持的文档格式

| 格式 | 扩展名 | 说明 |
|------|--------|------|
| 图片 | .jpg, .png, .bmp, .gif | 直接支持 |
| PDF | .pdf | 需要 pdf2image 库 |
| Word | .docx | 需要 python-docx 库 |

---

## 🌏 语言支持

### ✅ 完全支持中文提问

你可以用中文提问，例如：
- "总金额是多少？"
- "发票号是什么？"
- "日期是哪天？"
- "供应商名称是什么？"
- "合同编号是多少？"

### ✅ 也支持英文提问

英文提问效果可能更好（模型主要用英文训练）：
- "What is the total amount?"
- "What is the invoice number?"
- "What is the date?"
- "Who is the vendor?"

### 💡 提示

- **推荐使用英文提问**，因为模型主要在英文数据上训练
- 中文提问也能工作，但准确度可能略低
- 可以混合使用中英文

---

## 📝 使用步骤

### 1. 上传文档
- 点击上传区域或拖拽文档
- 支持：图片、PDF、Word文档

### 2. 输入问题
- 在问题框中输入你的问题（中文或英文）
- 或点击快捷按钮选择常见问题

### 3. 查看结果
- AI会分析文档并给出答案
- 显示置信度（越高越准确）

---

## 💡 使用技巧

### 提问技巧

**✅ 好的提问方式：**
- "总金额是多少？" / "What is the total amount?"
- "发票日期是什么？" / "What is the invoice date?"
- "客户名称是什么？" / "What is the customer name?"

**❌ 不好的提问方式：**
- "这个文档说了什么？"（太宽泛）
- "帮我分析一下"（不具体）

### 文档要求

- **清晰度**：文档图片要清晰，文字可辨认
- **格式**：表格、发票、合同等结构化文档效果最好
- **语言**：文档可以是中文或英文

---

## 🔧 常见问题

### Q1: 显示"Word支持未启用"怎么办？

**A:** 需要安装 python-docx 库：
```bash
pip install python-docx
```

然后**重启服务**（重要！）

### Q2: 可以用中文提问吗？

**A:** 可以！完全支持中文提问。
- 中文提问：例如"总金额是多少？"
- 英文提问：例如"What is the total amount?"
- 推荐使用英文提问，准确度更高

### Q3: 为什么识别不准确？

**可能原因：**
1. 文档图片不清晰
2. 问题描述不够具体
3. 文档格式复杂（手写、倾斜等）

**解决方法：**
- 使用高清晰度的文档图片
- 提问更具体明确
- 尝试用英文提问

### Q4: 支持哪些文档类型？

**最佳效果：**
- 发票（Invoice）
- 收据（Receipt）
- 表单（Form）
- 合同（Contract）
- 证书（Certificate）

**一般效果：**
- 普通文本文档
- 扫描件
- 截图

### Q5: 修改代码后不生效？

**A:** 需要重启服务！
1. 按 Ctrl+C 停止当前服务
2. 重新运行启动脚本

---

## 📊 应用场景

### 1. 发票处理
- 提取发票号、日期、金额
- 自动录入财务系统
- 批量处理发票

### 2. 合同分析
- 提取关键条款
- 识别合同编号、日期
- 提取甲乙方信息

### 3. 表单填充
- 自动识别表单内容
- 提取关键字段
- 数据验证

### 4. 文档自动化
- 批量文档处理
- 信息提取
- 数据整理

---

## 🎯 示例问题

### 发票类文档
```
中文：
- 发票号是多少？
- 开票日期是什么时候？
- 总金额是多少？
- 税额是多少？
- 购买方名称是什么？

英文：
- What is the invoice number?
- What is the invoice date?
- What is the total amount?
- What is the tax amount?
- Who is the buyer?
```

### 合同类文档
```
中文：
- 合同编号是什么？
- 签订日期是哪天？
- 甲方是谁？
- 乙方是谁？
- 合同金额是多少？

英文：
- What is the contract number?
- What is the signing date?
- Who is Party A?
- Who is Party B?
- What is the contract amount?
```

### 证书类文档
```
中文：
- 证书编号是什么？
- 颁发日期是什么时候？
- 持证人姓名是什么？
- 有效期到什么时候？

英文：
- What is the certificate number?
- What is the issue date?
- What is the holder's name?
- When does it expire?
```

---

## 🔍 技术说明

### 模型信息
- **模型名称**: impira/layoutlm-document-qa
- **模型类型**: LayoutLM（文档理解专用模型）
- **功能**: OCR + 布局分析 + 问答

### 工作原理
1. **OCR识别**: 提取文档中的文字
2. **布局分析**: 理解文档结构（表格、段落等）
3. **语义理解**: 理解问题和文档内容
4. **答案提取**: 从文档中找到答案

### 性能特点
- **准确度**: 对结构化文档（发票、表单）准确度高
- **速度**: 单次查询约2-5秒
- **语言**: 主要支持英文，中文也可用

---

## 📞 技术支持

如有问题，请检查：
1. Python环境是否正确（D:\aaaalokda\python.exe）
2. 依赖库是否安装（python-docx, pdf2image等）
3. 服务是否正常启动（查看控制台输出）
4. 文档格式是否支持

---

**祝使用愉快！📄✨**
