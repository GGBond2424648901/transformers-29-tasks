# 🎬 视频分类使用说明

## 📝 为什么视频分类使用图片？

### 技术原因

1. **模型要求**: VideoMAE模型需要固定数量的视频帧（通常是16帧）
2. **简化实现**: 在Web演示中，处理视频文件需要额外的视频解码库（如OpenCV、ffmpeg）
3. **快速体验**: 使用图片可以快速体验视频分类的效果

### 当前实现

- 上传一张图片
- 系统自动将图片复制为16帧
- 使用VideoMAE模型进行分类
- 返回识别结果

### 实际应用场景

在实际应用中，视频分类应该：
1. 接收视频文件（.mp4, .avi等）
2. 提取关键帧（通常每秒1-2帧）
3. 选择16帧作为输入
4. 进行分类

## 🔧 如何支持真正的视频文件？

如果需要支持视频文件上传，需要：

### 1. 安装视频处理库
```bash
pip install opencv-python
# 或
pip install av
```

### 2. 修改后端代码

```python
import cv2
import numpy as np

@app.route('/classify', methods=['POST'])
def classify():
    if 'video' not in request.files:
        return jsonify({'error': '没有上传视频'}), 400
    
    file = request.files['video']
    
    # 保存临时文件
    temp_path = 'temp_video.mp4'
    file.save(temp_path)
    
    # 提取视频帧
    cap = cv2.VideoCapture(temp_path)
    frames = []
    frame_count = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
    
    # 均匀采样16帧
    indices = np.linspace(0, frame_count-1, 16, dtype=int)
    
    for idx in indices:
        cap.set(cv2.CAP_PROP_POS_FRAMES, idx)
        ret, frame = cap.read()
        if ret:
            # 转换BGR到RGB
            frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
            frames.append(Image.fromarray(frame_rgb))
    
    cap.release()
    os.remove(temp_path)
    
    # 使用提取的帧进行分类
    inputs = processor(frames, return_tensors="pt").to(device)
    # ... 后续处理
```

### 3. 修改前端代码

```html
<input type="file" 
       id="fileInput" 
       accept="video/*" 
       onchange="handleFileSelect(event)">
```

## 💡 当前版本的优势

虽然当前版本只支持图片，但有以下优势：

1. **无需额外依赖**: 不需要安装OpenCV等视频处理库
2. **快速启动**: 可以立即使用，无需配置
3. **演示效果**: 可以快速体验VideoMAE模型的分类能力
4. **低资源消耗**: 处理图片比处理视频更快

## 🎯 使用建议

### 适合的图片类型
- 视频截图
- 动作场景图片
- 运动画面
- 活动照片

### 不适合的图片类型
- 静态风景照
- 纯文字图片
- 抽象图案

## 🔮 未来改进

可以考虑的改进方向：

1. **支持视频文件上传**
   - 添加视频解码功能
   - 智能提取关键帧
   - 显示视频预览

2. **支持GIF动图**
   - 提取GIF的所有帧
   - 选择代表性帧进行分类

3. **批量处理**
   - 支持上传多个图片
   - 批量分类

4. **实时视频流**
   - 支持摄像头输入
   - 实时分类

## 📚 相关资源

- [VideoMAE论文](https://arxiv.org/abs/2203.12602)
- [Hugging Face VideoMAE文档](https://huggingface.co/docs/transformers/model_doc/videomae)
- [OpenCV视频处理教程](https://docs.opencv.org/master/d6/d00/tutorial_py_root.html)

---

**当前版本**: 简化版（图片输入）  
**推荐用途**: 快速体验和演示  
**生产环境**: 建议实现完整的视频处理功能
